<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <style>
    </style>
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
  </head>
  <body>

    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>

    <canvas id="canvas">

    <script>

      var socket = io();
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');

      socket.on('blatout', function(data){
          console.log('data:', data)

          // var i = new ImageData(new Uint8ClampedArray(data.buffer),256,256);
          var i = new ImageData(new Uint8ClampedArray(data.buffer),256,256);
          ctx.putImageData(i,0,0);
          // console.log(blob);
          // var uint8Arr = new Uint8Array(blob);
          // var binary = '';
          // for (var i = 0; i < uint8Arr.length; i++) {
          //     binary += String.fromCharCode(uint8Arr[i]);
          // }
          // var base64String = window.btoa(binary);

          // var img = new Image();
          // img.onload = function() {
          //     canvas.width = img.width;
          //     canvas.height = img.height;
          //     var x = 0, y = 0;
          //     ctx.drawImage(data, x, y);
          // }
          // img.src = 'data:image/png;base64,' + base64String;
      });


    </script>

  </body>
</html>
