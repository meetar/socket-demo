<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <style>
    </style>

    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>

  </head>


  <body>

<script>


  var socket = io();

  socket.on('image', function(data) {
      // console.log(data.buffer);
      var uint8Arr = new Uint8Array(data.buffer);
      var binary = '';
      for (var i = 0; i < uint8Arr.length; i++) {
          binary += String.fromCharCode(uint8Arr[i]);
      }
      var base64String = window.btoa(binary);

      var img = new Image();
      img.onload = function() {
          var canvas = document.createElement('canvas');
          canvas.width = img.width;
          canvas.height = img.height;
          document.body.appendChild(canvas);
          var ctx = canvas.getContext('2d');
          var x = 0, y = 0;
          ctx.drawImage(this, x, y);
      }
      img.src = 'data:image/png;base64,' + base64String;
  });

</script>

  </body>
</html>